---
import DivBox1 from '@/components/atomos/DivBox1.astro';
import MainDashboard from '@/components/atomos/MainDashboard.astro';
import Modal from '@/components/moleculas/Modal.astro';
import Section from '@/components/moleculas/Section';

import AgendaLoader from '@/components/organismo/agenda/AgendaLoader.tsx';
import Calendario from '@/components/organismo/agenda/Calendario.tsx';
import { FormularioTurno } from '@/components/organismo/agenda/FormularioTurno.tsx';
import HorariosDisponibles from '@/components/organismo/agenda/HorariosDisponibles.tsx';
import TurnosDelDia from '@/components/organismo/agenda/TurnosDelDia.tsx';
import { FormularioNuevoPaciente } from '@/components/organismo/pacientes/FormularioNuevoPaciente.tsx';

const { user } = Astro.locals;
---

<MainDashboard h1="Agenda de Turnos">
  <div slot="botonera">
    <Modal id="modalNuevoTurno" title="Nuevo Turno">
      <FormularioTurno client:load />
    </Modal>
    <Modal id="modalNuevoPaciente" title="Nuevo Paciente">
      <FormularioNuevoPaciente client:load userId={user.id} />
    </Modal>
  </div>
  <div class="flex gap-4 w-full mb-8">
    <DivBox1>
      <p>Turnos Hoy</p>
    </DivBox1>
    <DivBox1>
      <p>Confimados</p>
    </DivBox1>
    <DivBox1>
      <p>Turnos Pendientes</p>
    </DivBox1>
    <DivBox1>
      <p>Turnos Cancelados</p>
    </DivBox1>
  </div>

  <div class="w-full flex gap-2 items-start justify-between h-full">
    <!-- Columna 1: Calendario -->
    <Section title="Seleccionar Fecha" classContent="px-8 py-4 w-fit">
      <Calendario client:load />
    </Section>

    <!-- Columna 2: Turnos Agendados -->
    <Section title="Turnos del DÃ­a" classContent="px-8 py-4 md:w-[35vw]">
      <TurnosDelDia client:load />
    </Section>

    <!-- Columna 3: Horarios Disponibles -->
    <Section title="Horarios Disponibles" classContent="px-8 py-4 md:w-[30vw]">
      <HorariosDisponibles client:load />
    </Section>
  </div>

  <!-- Este componente es invisible. Se encarga de cargar los datos en el store -->
  <AgendaLoader client:load userId={user.id} />
</MainDashboard>
